---
import DemoLayout from "../../../../layouts/DemoLayout.astro";
import { getComponents } from "../../../../utils/components";
import { loadDemo } from "../../../../utils/demo-loader";
import { siteConfig } from "../../../../data/site";
import CodePanel from "../../../../components/CodePanel.astro";
import { getUsageSnippet } from "../../../../utils/readme.js";

export function getStaticPaths() {
  const components = getComponents();
  return components.map((component) => ({
    params: { slug: component.slug },
    props: { component },
  }));
}

const { component } = Astro.props;
const snippet = getUsageSnippet(component.slug);
const demo = loadDemo(component.slug, "demo");
const links = [
  { label: "‚Üê Back to components", href: siteConfig.basePath || "/" },
  { label: "GitHub Repo", href: siteConfig.repoUrl },
];

if (component.hasPlayground) {
  links.push({ label: "Playground", href: `../../${component.slug}/playground/` });
}
---
<DemoLayout title={component.title} subtitle={component.description} links={links}>
  {demo ? (
    <>
      {demo.links && <div set:html={demo.links} />}
      {demo.styles && <div set:html={demo.styles} />}
      <div class="demo-embed" set:html={demo.body} />
      {demo.scripts && <div set:html={demo.scripts} />}
    </>
  ) : (
    <p>No demo content found.</p>
  )}
  {snippet && <CodePanel code={snippet.code} language={snippet.language} />}
</DemoLayout>
